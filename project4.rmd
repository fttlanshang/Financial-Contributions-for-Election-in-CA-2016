Financial Contributions to Presidential Campaigns by CA in 2016
========================================================

```{r echo=FALSE, message=FALSE, warning=FALSE, packages}
# The other parameters for "message" and "warning" should also be set to FALSE
# for other code chunks once you have verified that each plot comes out as you
# want it to. This will clean up the flow of your report.

library(ggplot2)
library(lubridate)
library(dplyr)
library(reshape2)
library(RColorBrewer)
library(zipcode)
library(ggmap)
getwd()
setwd("D:/Udacity-DAND/project 4")
```

```{r echo=FALSE, Load_the_Data}
original_financial <- read.csv('./P00000001-CA.csv')
```

The dataset was a collection of financial contributions to presidential campaigns by CA in 2016. 

# Univariate Plots Section
```{r echo=FALSE}

dim(original_financial)
str(original_financial)
summary(original_financial)

```
This dataset contained 19 variables and 130,4346 observations. And most variables are factor variables. 

### Contribution Receipt Amount Distribution
From the summary, we could see that there were negative values for contribution receipt amount, which seemed pretty weird for me. So in my whole exploration, I excluded negative records.

Since the contribution receipt amount distribution was highly skewed, so I transformed the long tail data to log scale. And the distribution was kind of like a normal distribution in log scale. And most contributions were around tens or hundreds.

```{r echo=FALSE, Univariate_Plots}
# Also, I don't know the unit, I think at least it's thousands..
financial <- subset(original_financial, contb_receipt_amt > 0)

amt_p1 <- ggplot(aes(x = contb_receipt_amt), data = financial) + 
  geom_histogram(bins = 50)  +
  labs(x = "contribution receipt amount",
       y = "count", title = "Financial Contribution Amount Distribution")
amt_p1
amt_p2 <- amt_p1 + scale_x_log10()
amt_p2

```

###  Committee & Candidate
At first, I didn't know the relationship between committees and candidates. But I found both variables had 25 unique values. So I combined the two variable to form a new one to check whether committee id and candidate id were related one by one. Actually, the answer was yes.

This bar chart shows that there were orders of magnitude difference of the financial support times. Four candidates, i.e., Clinton, Hillary Rodham and Sanders, Bernard and Trump, Donald J. and Cruz, Rafael Edward 'Ted', received financial support for most times. And Hillary Clinton was the top 1 candidate in receiving financial support ranked by count. Also, from the support times, we could tell that Democratic was more popular within CA.

```{r echo=FALSE}
# length(unique(financial$cmte_id)) # 25 unique committees
# length(unique(financial$cand_nm)) # 25 unique candidates
# how to check committee id and candidate id are related one by one?
financial$cmte_cand <- paste(financial$cmte_id, financial$cand_nm, sep = '_')
# length(unique(financial$cmte_cand)) #25
# So each candidate has a committee, thus I would focus on the candidate

ggplot(aes(x = cand_nm), data = financial) + geom_bar() + 
  theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
  xlab("candidate name") + ylab("count") +
  labs(title = "Financial support times for each candidate in CA, 2016")

```

### Contributing Cities
Actually, there were 2517 unique cities contributed for the presidential campaign in CA in 2016. Here, I only showed the top 10 contributing cities ranked by count. We can easily figure out that Los Angeles, San Francisco and San Diego were top 3 contributing cities ranked by contribution times.

```{r echo=FALSE, warning=FALSE}
length(unique(financial$contbr_city)) # 2517 unique contributor cities

top_10_contributing_cities_by_times <- financial %>%
  group_by(contbr_city) %>%
  summarise(n = n()) %>%
  filter(rank(desc(n)) <= 10) %>%
  transform(contbr_city =reorder(contbr_city, -n))

ggplot(aes(x = contbr_city, y = n), 
       data = top_10_contributing_cities_by_times) +
  geom_histogram(stat = "identity") +
  xlab("city name") + ylab("count") +
  labs(title = "Contribution Times for Top 10 Cities ") +
   theme(axis.text.x = element_text(angle = 90, hjust = 1))

```
### Occupation

There were even more occupations in this dataset. Like city, I would only plot the top 10 occupations ranked by contribution times.

From the bar chart, I was quite curious why the retired and not employed people contributed most. Maybe because they were old and accumulated much money.

```{r echo=FALSE, warning=FALSE}
length(unique(financial$contbr_occupation)) #28563

top_10_occupation_by_times <- financial %>%
  group_by(contbr_occupation) %>%
  summarise(n = n()) %>%
  filter(rank(desc(n)) <= 10) %>%
  transform(contbr_occupation = reorder(contbr_occupation, -n))

ggplot(aes(x = contbr_occupation, y = n), 
       data = top_10_occupation_by_times) +
  geom_histogram(stat = "identity") +
  xlab("occupation names") + ylab("count") +
  labs(title = "Contribution Times for Top 10 Occupations ") +
   theme(axis.text.x = element_text(angle = 90, hjust = 1))

```

### Contribution Time Distribution

Since contribution time was considered as a factor variable, I needed to transform it to datatime first. Here, I simply replaced the variable with Date format. Also, I created another column in this dataset, which only recorded the year and month of the contribution, which was used for later exploration and analysis.

When looking at the summary, we could find that the earliest contribution started on 2013. Actually, we could see from the bar chart that most contributions were made in 2016. And there are two peaks in 2016, one in 201603 (during primary election), and the other in 201610 (one month before the general election).

```{r echo=FALSE}

financial$contb_receipt_dt <- dmy(financial$contb_receipt_dt)
# Now the variable is Date format.
 
financial$contb_receipt_dt_yr_mo <- strftime(financial$contb_receipt_dt, "%Y%m")

ggplot(aes(x = contb_receipt_dt_yr_mo), data = financial) + 
  geom_bar() + labs(x = "time", y = "count",
                    title = "Financial Contribution Throuth Time") +
  theme(axis.text.x = element_text(angle = 90, hjust = 1))

```

### Form Type

In the explanation file, there were 3 different form types, individual contributions(SA17A), transfers from authorized committees(SA18) and refunds to individuals(SA28A).

When using whole dataset(containing negative contribution receipt amount), all three types appeared. But when using positive subset(which was used through the exploration), SA28A type disappeared. But actually, I once substracted the negative subset and looked at its summary data, all 3 types were concluded, not only SA28A included.

No longer which dataset to use, individual contributions accounted for a large proportion.

```{r echo=FALSE}

ggplot(aes(x = form_tp), data = original_financial) + geom_bar() +
  labs(x = "from type", y = "count", title = "Different form types using whole dataset")

ggplot(aes(x = form_tp), data = financial) + geom_bar() +
  labs(x = "from type", y = "count", title = "Different form types using positive subset")

```

### Election Type
Actullay, most contributions were made for primary election and general election.

```{r echo=FALSE}

ggplot(aes(x = election_tp), data = financial) + geom_bar() +
  labs(x = "election type", y = "count", title = "Financial Contributions for Different Election Types")

```

# Univariate Analysis

### What is the structure of your dataset?

Most of the variables are factor variables, like contributing city, contributing name and etc. It was not a cross section dataset(snapshot taken at a given time). It recorded every financial contribution during the election process.

### What is/are the main feature(s) of interest in your dataset?

- The financial contribution amount distribution was kind of a normal distribution in log scale. And most contributions' amounts were between tens to hundreds.
- There were 25 candidateds being financially supported during the presidential campaign in 2016. The Democratic was well supported compared to the other parties. And Clinton, Hillary Rodham and Sanders, Bernard received top 2 financial contributions ranked by count.
- There were more than 2500 cities contributed in this presidential campaign in CA in 2016, of which  Los Angeles, San Francisco and San Diego were top 3 contributing cities ranked by contribution times.
- It was really surprised to find that retired men and not employed people contributed for most times among all occupations.
- When looking at the total contribution amount for each month, we could figure out that most contributions were made in 2016. And there were two contribution peaks, one in 201603(during primary election), and the other in 201610(one month before the general election).
- Actullay, most contributions were made for primary election and general election.
- Most contributions came from indivials.

### Did you create any new variables from existing variables in the dataset?
There were a few changes I made to the original dataset.
(1) I changed the format of the contribution date and also creates another column(called `contb_receipt_dt_yr_mo`) representing the year and month of the contribution.
(2) I combined the committee id and candidate name to form a new column to check whether committees and candidates were correlated one by one.
(3) I created another two variables, i.e., top 10 cities and top 10 occupations ranked by contribution times since there were too many levels for cities and occupations.

### Of the features you investigated, were there any unusual distributions? \
Did you perform any operations on the data to tidy, adjust, or change the form \
of the data? If so, why did you do this?

(1) There were some records with negative contribution receipt amount in the dataset(called `original_financial`). So I excluded all negative values in my dataset and I used modified dataset(called `financial`) for my exploration.
(2) And retired man contributed most times of all occupations, which really surprised me.

# Bivariate Plots Section

When doing the univariate visualizations and analysis, the y axis for bar charts or histograms was count, or contribution times. And since each contribution receipt amount was different, so it was a good idea to explore how total contribution amount varied with some categorical variables. To achieve this, aggregation was needed.

### Candidate & Contribution Receipt Amount

From the first plot, we could see that there was orders of magnitude difference for each candidate. So I changed to log10 scale for better understanding. Of all candidates, Clinton, Hillary Rodham received the most total contribution amount.

```{r echo=FALSE, Bivariate_Plots}
financial.cand_id_amt <- financial %>%
  group_by(cand_nm) %>%
  summarise(total_amt = sum(contb_receipt_amt)) %>%
  arrange(cand_nm) %>%
  transform(cand_nm = reorder(cand_nm, -total_amt))

candidate_p1 <- ggplot(aes(x = cand_nm, y = total_amt), data = financial.cand_id_amt) +
  geom_bar(stat = "identity") +
  labs(x = "candidate name", y = "total amount received",
      title = "Total Financial Support Amount for each candidate") +
  theme(axis.text.x = element_text(angle = 90, hjust = 1))
candidate_p1
candidate_p2 <- candidate_p1 + scale_y_log10()
candidate_p2

```

### City & Receipt Amount

Since there were more than 2500 cities in this dataset, so I would still explore top 10 cities, but this time with total contribution amount. While considering the total financial support amount, rather than contribution times, San Francisco and Los Angeles were still top 2 cities, while the other cities' difference got less.

```{r echo=FALSE}
top_10_contributing_cities <- financial %>%
  group_by(contbr_city) %>%
  summarise(total_amt = sum(contb_receipt_amt)) %>%
  filter(rank(desc(total_amt)) <= 10) %>%
  transform(contbr_city = reorder(contbr_city, -total_amt))

ggplot(aes(x = contbr_city, y = total_amt), 
       data = top_10_contributing_cities) + 
  geom_bar(stat = 'identity') +
  labs(x = "city name", y = "total amount received",
      title = "Total Financial Support Amount from Top 10 Cities") +
  theme(axis.text.x = element_text(angle = 90, hjust = 1))
  
```
### top 10 contribution city & candidate

Here I only cared about three candidates, Clinton, Hillary Rodham, Sanders, Bernard and Trump, Donald J. While Clinton and Sanders had very similar trend in each city, Trump differed. Contributions from San Diego accounted a large propotion for Trump, while was not true for Clinton and Sander. **So it was natural to think that different cities had different preferences in candidate and party.**

```{r}

top_3_candidates <- c("Clinton, Hillary Rodham", "Sanders, Bernard", "Trump, Donald J.")

ggplot(aes(x = contbr_city), data = subset(financial, 
      contbr_city %in% top_10_contributing_cities_by_times$contbr_city & cand_nm %in% top_3_candidates )) + geom_bar() +
  facet_wrap(~cand_nm, scales = "free_y") + 
  labs(x = "city name", y = "count",
      title = "Total Financial Contribution Times from Top 10 Cities") +
  theme(axis.text.x = element_text(angle = 90, hjust = 1))
```

### Contribution Time & Contribution Receipt Amount

Obviously, the distribution was qiute different from the one gotten from  univariate plotting. Contributions in 2015 seemed to accounted for a larger proportion. Maybe it was due to large amount per contribution in 2015. Also, 201607-201610 were the most intense periods. 

```{r echo=FALSE}

financial.dt_amt <- financial %>%
  group_by(contb_receipt_dt_yr_mo) %>%
  summarise(total_amt = sum(contb_receipt_amt)) %>%
  arrange(contb_receipt_dt_yr_mo)

ggplot(aes(x = contb_receipt_dt_yr_mo, y = total_amt ), 
       data = financial.dt_amt) + 
  geom_bar(stat = 'identity') +
  labs(x = "time", y = "total amount received",
      title = "Total Financial Support Amount Through Time") +
  theme(axis.text.x = element_text(angle = 90, hjust = 1))

```

### Candidate & Election Type

We can see that during primary election, more candidates were financially supported, which was consistent with the election rule.

```{r echo=FALSE}

ggplot(aes(x = cand_nm), data = 
      subset(financial, election_tp == 'P2016' | election_tp == 'G2016')) + 
  geom_bar() +
  facet_wrap(~election_tp, ncol = 2) + 
  labs(x = "candidate name", y = "count",
      title = "Financial Contribution Times for Each Candidate\nDuring Different Election Period") +
  theme(axis.text.x = element_text(angle = 90, hjust = 1))
  
```

# Bivariate Analysis

### Talk about some of the relationships you observed in this part of the \
investigation. How did the feature(s) of interest vary with other features in \
the dataset?

- When doing univariate analysis, I explored the count(contribution times) of some variables, like contribution city, candidate name. And when doing bivariate analysis, I primarily changed the frequency(contribution times) to contribution receipt amount. And the most conclusions in univariate analysis still worked for bivariate analysis, but the distribution changed. 

### Did you observe any interesting relationships between the other features \
(not the main feature(s) of interest)?
- Candidates got different "treatment" in different cities which may be due to cities' party perference. For example, contributions from San Diego accounted a large propotion for Trump, while was not true for Clinton and Sander.
- The election rule affected the actual data. Some candidates didn't stand out from the primary election, then they couldn't compete in general election. Thus only a few candidates receive financial support. Even though Sanders received more contribution than Trump, Clinton won Sanders and she was supported at last.

### What was the strongest relationship you found?

Since there were only one numerical variable(i.e., contribution receipt amount), so scatterplot was not suitable here. Thus no linear or non-linear relationship were found in this dataset. But We could still see that the contribution receipt amount varied as the candidate or contributing city changed.

# Multivariate Plots Section

### City & Candidate & Contribution Receipt Amount

It was very similar to the bivariate one talked above, except changed from count to financial receipt amount. So here I still only cared about three candidates, Clinton, Hillary Rodham, Sanders, Bernard and Trump, Donald J. 

When using the total receipt amount as y axis, the trend for Clinton and Sanders were not similar any more. And Trump also received most contribution amount from Los Angeles. And note, Trump received most contribution times from San Diego.

```{r echo=FALSE, warning=FALSE}

financial.city_cand_amt <- financial %>%
  group_by(cand_nm, contbr_city) %>%
  summarise(total_amt = sum(contb_receipt_amt))
# Do I need to ungroup data??

ggplot(aes(x = contbr_city, y = total_amt), 
       data = subset(financial.city_cand_amt, 
      contbr_city %in% top_10_contributing_cities_by_times$contbr_city & cand_nm %in% top_3_candidates)) + 
  geom_histogram(stat = "identity") +
  facet_wrap(~cand_nm, scales = "free_y") + 
  labs(x = "city name", y = "financial contribution amount",
      title = "Total Financial Support Amount from Top 10 Cities") +
  theme(axis.text.x = element_text(angle = 90, hjust = 1))
```

### Election Type & Contribution Amount & Candidate

To better visualization, I transformed y axis to log scale. And I think that the biggest trend didn't change for primary and general election, while the relative position for less supported candidates actually changed.

```{r echo=FALSE, warning=FALSE}

financial.election_tp_cand_amt <- financial %>%
  group_by(cand_nm, election_tp) %>%
  summarise(total_amt = sum(contb_receipt_amt))

ggplot(aes(x = cand_nm, y = total_amt), 
       data = subset(financial.election_tp_cand_amt, 
      election_tp == 'G2016' | election_tp == 'P2016')) + 
  geom_histogram(stat = "identity") + scale_y_log10() +
  facet_wrap(~election_tp, scales = "free_y") + labs(x = "candidate name", y = "financial contribution amount",
      title = "Financial Contribution Times for Each Candidate \n During Different Election Period") + theme(axis.text.x = element_text(angle = 90, hjust = 1))

```

### Contribution Amount & Candidate & Time

Since the dataset was not a cross-section one, it was a good idea to look at how the support trend varied with time for each candidate. 

Trend for each candidate varied a lot. Clinton kept "smooth" contribution through the process, while some candidates went up and down, like Cruz, Rafael Edward 'Ted'. 

There were candidates receiving support from a quite early time, like Paul, Rand. While some candidates received financial support from very late period, like McMullin, Evan. I thought this plot contained much information. It was better to explore if I combined the data with the events in reality.

```{r echo=FALSE, Multivariate_Plots}
table(financial$cand_nm)

financial.cand_dt_amt <- financial %>%
  group_by(cand_nm, contb_receipt_dt_yr_mo) %>%
  summarise(total_amt = sum(contb_receipt_amt))

ggplot(aes(x = contb_receipt_dt_yr_mo, y = total_amt),
       data = financial.cand_dt_amt) + geom_point() + scale_y_log10() +
  facet_wrap(~cand_nm) + 
  labs(x = "time", y = "contribution receipt amount",
      title = "Financial Support Amount Through Time for Each Candidate") +
  theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
  scale_x_discrete(breaks = seq(201308, 201612, 4))

```
### Contribution Amount & City & Time

The contribution trend for each city seemed quite similar. First increase, then keeping smooth, and at last dropped.

```{r echo=FALSE}
financial.city_dt_amt <- financial %>%
  group_by(contb_receipt_dt_yr_mo, contbr_city) %>%
  summarise(total_amt = sum(contb_receipt_amt))

ggplot(aes(x = contb_receipt_dt_yr_mo, y = total_amt),
       data = subset(financial.city_dt_amt, 
          contbr_city %in% top_10_contributing_cities$contbr_city)) + 
  geom_point() + scale_y_log10() +
  facet_wrap(~contbr_city) + 
  labs(x = "time", y = "contribution receipt amount",
      title = "Financial Support Amount Through Time from Each City") +
  theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
  scale_x_discrete(breaks = seq(201308, 201612, 4))
```

### Map distribution

To plot on the map, first, I grouped the contribution amount by zipcode, then, I combined aggregated data with `zipcode`, which was provided by package `zipcode`, to get latitude and longitude. So in this plot, the size of circles represented the total contribution amount during 2016 presidential campaign.

Actually, this plot was not as explicit as the previous ones, because it was a little hard to distinguish between each city. But the advantage of this map was that it showed all cities, not just top 10 cities any more.

```{r echo=FALSE, warning=FALSE}
data(zipcode)

financial$modified_contbr_zip <- clean.zipcodes(financial$contbr_zip)
# I need to aggregate the same zipcode together, 
# I can first aggregate, then merge it with zipcode
financial.zip_amt <- financial %>%
  group_by(modified_contbr_zip) %>%
  summarise(total_amt = sum(contb_receipt_amt)) %>%
  arrange(modified_contbr_zip)

new_financial <- merge(financial.zip_amt, zipcode, 
                       by.x='modified_contbr_zip',
                       by.y='zip')
# with map version
qmplot(longitude, latitude, size = total_amt,
       data = subset(new_financial, state == 'CA'), 
      color = I("orange"), alpha = 1 / 20)

```
### General Election Preference for Clinton or Trump

Here, I only cared about Hillary Clinton and Donald Trump. And I would only use the contribution data for general election.

While ratio 1 meant that the city only contributed to Clinton, and ratio 0 meant the city only contributed to Trump. And We could see from this plot that different cities had different preferences, which may need further exploration.

```{r echo=FALSE, warning=FALSE}

financial_for_g2016_top_2 <- subset(financial, election_tp == 'G2016' & 
  (cand_nm == "Trump, Donald J." | cand_nm == "Clinton, Hillary Rodham" ))

financial_for_g2016_top_2.cand_zip_amt <- financial_for_g2016_top_2 %>%
  group_by(cand_nm, modified_contbr_zip) %>%
  summarise(total_cand_amt = sum(contb_receipt_amt))

# I need to transform the long format to wide format?
financial_for_g2016_top_2.cand_zip_amt.wide <- dcast(financial_for_g2016_top_2.cand_zip_amt, modified_contbr_zip ~ cand_nm, value.var = "total_cand_amt")
# head(financial_for_g2016_top_2.cand_zip_amt.wide)

financial_for_g2016_top_2.cand_zip_amt.wide$ratio <- financial_for_g2016_top_2.cand_zip_amt.wide$`Clinton, Hillary Rodham` / (financial_for_g2016_top_2.cand_zip_amt.wide$`Clinton, Hillary Rodham` + financial_for_g2016_top_2.cand_zip_amt.wide$`Trump, Donald J.`)

financial_for_g2016_top_2.cand_zip_amt.wide$ratio <- if_else(is.na(financial_for_g2016_top_2.cand_zip_amt.wide$`Clinton, Hillary Rodham`), 0, financial_for_g2016_top_2.cand_zip_amt.wide$ratio)

financial_for_g2016_top_2.cand_zip_amt.wide$ratio <- if_else(is.na(financial_for_g2016_top_2.cand_zip_amt.wide$`Trump, Donald J.`), 1, financial_for_g2016_top_2.cand_zip_amt.wide$ratio)

# head(financial_for_g2016_top_2.cand_zip_amt.wide)

financial_for_g2016_top_2.cand_zip_amt.wide.position <- merge(financial_for_g2016_top_2.cand_zip_amt.wide, zipcode, 
                       by.x='modified_contbr_zip',
                       by.y='zip')

# head(financial_for_g2016_top_2.cand_zip_amt.wide.position)

qmplot(longitude, latitude, color = ratio,
       data = subset(financial_for_g2016_top_2.cand_zip_amt.wide.position, state == 'CA'), 
       alpha = 1 / 20) 


```

### General Election Prediction

Here, I simply used the financial contribution data to predict the general election result. And we may get the result that Hillary Clinton would win CA, but the actual ratio(61.73%) was much lower than predicted one(80.48%).

It may be due to bias. Bbecause only rich people would contribute to the candidates and normal people were not considred in this prediction.

```{r echo=FALSE}

financial_for_general_election <- subset(financial,
          election_tp == 'G2016' & contb_receipt_amt > 0)

financial_for_general_election_sum <- financial_for_general_election %>%
  group_by(cand_nm) %>%
  summarise(total_amt = sum(contb_receipt_amt),
            n = n())

financial_for_general_election_sum$amt_ratio <- financial_for_general_election_sum$total_amt / sum(financial_for_general_election_sum$total_amt)

financial_for_general_election_sum

```

# Multivariate Analysis

### Talk about some of the relationships you observed in this part of the \
investigation. Were there features that strengthened each other in terms of \
looking at your feature(s) of interest?
- As discussed from the bivariate analysis, I learned that different cities had different preferences. And in this part, I not only explored the how contribution amount among different cities. I also drew the preference on the map and the preference is calculates using the financial contribution amount ratio and only Clinton and Trump was considered on the map.
- The contribution trend for each city seemed quite similar.
- The contribution trend for each candidated was quite different. Some candidates kept smooth, whild some kept up and down. And the starting time and lasting time also varied a lot.

### Were there any interesting or surprising interactions between features?

### OPTIONAL: Did you create any models with your dataset? Discuss the \
strengths and limitations of your model.

I used a very simple model to predict who would won CA in general election. And the result was consistent with reality, but the ratio was pretty much biased. 

I thought the this method may tell who will win one specific state when the contribution data for two main competitors had a big difference, like this dataset. But when the contribution amount was quite similar, this method would fail with pretty large probability.

And I thought the bias came from the non-respondents bias. Since only rich peole would contributed and normal people were not considered in this prediction.
------

# Final Plots and Summary

### Plot One
```{r echo=FALSE, Plot_One}
candidate_p2

```

### Description One
This plot shows the total contribution amount each candidate received in the presidential election campaign. From this plot, we could easily figure out the most popular candidate in CA, 2016. And we could also figure out the democratic party were more popular than other parties.

### Plot Two
```{r echo=FALSE, Plot_Two}
ggplot(aes(x = contb_receipt_dt_yr_mo, y = total_amt),
       data = financial.cand_dt_amt) + geom_point() + scale_y_log10() +
  facet_wrap(~cand_nm) + 
  labs(x = "time", y = "contribution receipt amount",
      title = "Financial Support Amount Through Time for Each Candidate") +
  theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
  scale_x_discrete(breaks = seq(201308, 201612, 4))

```

### Description Two
This plot showed the how contribution amount varied with time for each candidate. And I thought this plot wasn full of information. We could see the ups and downs for a given candidate(especially for the less supported candidates, because Clinton and some other candidates kept similar contributions all the time). And I thought it was consistent with real events.

### Plot Three
```{r echo=FALSE,warning=FALSE, Plot_Three}
qmplot(longitude, latitude, color = ratio,
       data = subset(financial_for_g2016_top_2.cand_zip_amt.wide.position, state == 'CA'), 
       alpha = 1 / 20) 
```

### Description Three
This plot showed different cities had different preferences. 

------

# Reflection

In this dataset, I'm interested to find how was each candidate being supported financially in presidential campign in CA and want to figure out who was the most popular candidate in CA, 2016. I'm also interested in using financial support data to predict the proportion of votes in general election in CA£¬2016. I thought I've basically finished my goal.

For univariate analysis, I mainly explored the frequency or contribution times for one categorical variables. And for bivariate analysis, I changed the frequency to actual total contribution amount.  And for multivariate analysis, I plotted how the contribution amount changed through time for a categorical variable. Also, I combined the data with geographic information.

There are times that I got confused on frequency and total amount. So, it was a good idea to jump out of the analysis and consider the whole analysis at times.

What I found interesting or surprising was as follows:
- Different cities had different preferences over candidates.
- Each candidate went different ups and downs through the election process.
- I still couldn't understand why retired or not employed people contributed most.

Before the analysis, I knowed little about the election process and was confused by primary election and general election. But through the exploration process, I gained some knowledge about American election.

For future analysis, I would think to intepret the data better, it would be very important to combine the data with reality.



> **Tip**: Here's the final step! Reflect on the exploration you performed and
the insights you found. What were some of the struggles that you went through?
What went well? What was surprising? Make sure you include an insight into
future work that could be done with the dataset.
